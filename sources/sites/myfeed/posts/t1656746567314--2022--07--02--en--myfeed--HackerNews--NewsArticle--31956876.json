{
  "@type": "NewsArticle",
  "identifier": "2022--07--02--en--myfeed--HackerNews--NewsArticle--31956876",
  "url": "https://news.ycombinator.com/item?id=31956876",
  "headline": "Tell HN: Gitlab is splitting their main and ci Postgres DBs",
  "publisher": {
    "@type": "Organization",
    "name": "HackerNews",
    "url": "https://news.ycombinator.com",
    "logo": "https://hn.buzzing.cc/avatar.png"
  },
  "description": "DISCLAIMER: I do some paid work with with Open Core Ventures[0] and I've been a GitLab fan for a while so I'm quite biased.<p>Just tried to use some GitLab repos I have and ran into a well specified 503 error page:<p>&gt; We are splitting our database into Main and CI!\n&gt;\n&gt; For more information about what we're up to, you can check out our blog article. For progress updates, please check our status page.<p>https://about.gitlab.com/blog/2022/06/02/splitting-database-into-main-and-ci/<p>Don't know how I missed it, but it's pretty nice that the downtime is clearly specified, and the blog post (and related posts) were very informative.<p>Some random thoughts below:<p>&gt; GitLab.com's database architecture uses a single PostgreSQL database cluster. This single cluster (let's call it main), consists of a single primary and multiple read-only replicas and stores the data generated by all GitLab features. Database reads can be scaled horizontally through read-only replicas, but writes cannot because PostgreSQL does not support active-active replication natively.<p>All you need is Postgres. IIRC Reddit had a similar starting story.<p>Excited to see how much faster gitlab.com will be and how much more reliable their CI gets (I don't have numbers on hand, but I think they've gone down less than GH Actions in recent memory at least -- maybe there's some recency bias there).<p>In a world where Citus is now fully open source[1], I wonder if it needs to just get pulled into contrib.<p>[0]: https://opencoreventures.com/<p>[1]: https://www.citusdata.com/blog/2022/06/17/citus-11-goes-fully-open-source/",
  "keywords": [],
  "author": {
    "@type": "Person",
    "name": "hardwaresofton",
    "url": "https://news.ycombinator.com/user?id=hardwaresofton"
  },
  "discussionUrl": "https://news.ycombinator.com/item?id=31956876",
  "sameAs": "https://news.ycombinator.com/item?id=31956876",
  "dateCreated": "2022-07-02T07:22:47.314Z",
  "datePublished": "2022-07-02T07:04:40.000Z",
  "dateModified": "2022-07-02T07:22:47.314Z",
  "interactionStatistic": [
    {
      "@type": "InteractionCounter",
      "interactionType": {
        "@type": "LikeAction"
      },
      "userInteractionCount": 2
    },
    {
      "@type": "InteractionCounter",
      "interactionType": {
        "@type": "CommentAction"
      },
      "userInteractionCount": 0
    }
  ],
  "headline_zh-Hans": "告诉HN：Gitlab正在拆分他们的主数据库和Ci Postgres数据库\n",
  "headline_zh-Hant": "告訴HN：Gitlab正在拆分他們的主數據庫和Ci Postgres數據庫\n",
  "@context": [
    "https://schema.org",
    {
      "@vocab": "http://schema.org/",
      "@language": "en",
      "headline_zh-Hans": {
        "@id": "headline",
        "@language": "zh-Hans"
      },
      "headline_zh-Hant": {
        "@id": "headline",
        "@language": "zh-Hant"
      },
      "@version": 1.1,
      "description_zh-Hans": {
        "@id": "description",
        "@language": "zh-Hans"
      },
      "description_zh-Hant": {
        "@id": "description",
        "@language": "zh-Hant"
      }
    }
  ],
  "description_zh-Hans": "DISCLAIMER：我在Open Core Ventures[0]做一些有偿工作，而且我已经是GitLab的粉丝了，所以我很有偏见。<p>刚刚试图使用我拥有的一些GitLab仓库，但遇到了一个规定好的503错误页面：<p>&gt; 我们正在将我们的数据库分成Main和CI!\n&gt;\n&gt; 关于我们正在进行的更多信息，你可以查看我们的博客文章。如需了解最新进展，请查看我们的状态页面。<p>https://about.gitlab.com/blog/2022/06/02/splitting-database-into-main-and-ci/<p>不知道我是怎么错过的，但明确规定了停机时间，而且博文（和相关帖子）的信息量很大，这一点相当不错。<p>下面是一些随机的想法：<p>&gt; GitLab.com的数据库架构使用单一的PostgreSQL数据库集群。这个单一的集群（我们称之为主集群），由一个主集群和多个只读副本组成，存储所有GitLab功能产生的数据。数据库的读取可以通过只读复制进行横向扩展，但写入不能，因为PostgreSQL不支持主动-主动复制。<p>我很想知道gitlab.com的速度会有多快，他们的CI会有多可靠（我手头没有数字，但我认为他们至少在最近的记忆中比GH Actions下降得少--也许那里有一些时间偏差）。<p>在Citus现在完全开源的世界里[1]，我想知道它是否需要被拉入contrib。<p>[0]: https://opencoreventures.com/<p>[1]: https://www.citusdata.com/blog/2022/06/17/citus-11-goes-fully-open-source/\n",
  "description_zh-Hant": "DISCLAIMER：我在Open Core Ventures[0]做一些有償工作，而且我已經是GitLab的粉絲了，所以我很有偏見。<p>剛剛試圖使用我擁有的一些GitLab倉庫，但遇到了一個規定好的503錯誤頁面：<p>&gt; 我們正在將我們的數據庫分成Main和CI!\n&gt;\n&gt; 關於我們正在進行的更多信息，你可以查看我們的博客文章。如需瞭解最新進展，請查看我們的狀態頁面。<p>https://about.gitlab.com/blog/2022/06/02/splitting-database-into-main-and-ci/<p>不知道我是怎麼錯過的，但明確規定了停機時間，而且博文（和相關帖子）的信息量很大，這一點相當不錯。<p>下面是一些隨機的想法：<p>&gt; GitLab.com的數據庫架構使用單一的PostgreSQL數據庫集群。這個單一的集群（我們稱之為主集群），由一個主集群和多個只讀副本組成，存儲所有GitLab功能產生的數據。數據庫的讀取可以通過只讀複製進行橫向擴展，但寫入不能，因為PostgreSQL不支持主動-主動複製。<p>我很想知道gitlab.com的速度會有多快，他們的CI會有多可靠（我手頭沒有數字，但我認為他們至少在最近的記憶中比GH Actions下降得少--也許那裡有一些時間偏差）。<p>在Citus現在完全開源的世界裡[1]，我想知道它是否需要被拉入contrib。<p>[0]: https://opencoreventures.com/<p>[1]: https://www.citusdata.com/blog/2022/06/17/citus-11-goes-fully-open-source/\n"
}