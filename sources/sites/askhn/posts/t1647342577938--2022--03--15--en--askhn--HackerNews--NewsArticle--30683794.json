{
  "@type": "NewsArticle",
  "identifier": "2022--03--15--en--askhn--HackerNews--NewsArticle--30683794",
  "url": "https://news.ycombinator.com/item?id=30683794",
  "headline": "Ask HN: Why can't I access HTTP://news.yahoo.com through this firewall script?",
  "publisher": {
    "@type": "Organization",
    "name": "HackerNews",
    "url": "https://news.ycombinator.com",
    "logo": "https://hn.buzzing.cc/avatar.png"
  },
  "description": "I am stumped.  I've run a Linux firewall for years using an &quot;iptables&quot; based configuration.  Never a problem.  The current gateway machine is running on CENTOS 6 installed 10 years ago, so it's time for an upgrade.<p>I installed Redhat Enterprise 8.5 (using a free personal developer licence) which comes with kernel 4.18.  Decided to modernize and use an nft based firewall script.<p>At first glance it works.  But a subset of the internet is inaccessible.  Specifically, any attempt to access http://news.yahoo.com fails from any machine other than the gateway machine itself.  Paring the script down to the bare minimum, which I paste here:<p>table ip nat {\n chain postrouting {\n  type nat hook postrouting priority filter; policy accept;\n  oifname &quot;ppp0&quot; masquerade\n }\n}<p>everything works except news.yahoo.com (and it appears other things on the same CDN or whatever).<p>I figured I'd wait until RHEL9 and its newer kernel, but I did a test using another machine running FC39 (same kernel version) and the problem is the same.<p>These setups can still load my old iptables based firewall config.  That also works but also has the problem above.  It does not on the old CENTOS 6 machine.  I'm stumped.  Where can I even begin to go for help with this?",
  "keywords": [
    "Ask HN"
  ],
  "genre": "Ask HN",
  "author": {
    "@type": "Person",
    "name": "MarkusWandel",
    "url": "https://news.ycombinator.com/user?id=MarkusWandel"
  },
  "discussionUrl": "https://news.ycombinator.com/item?id=30683794",
  "sameAs": "https://news.ycombinator.com/item?id=30683794",
  "dateCreated": "2022-03-15T11:09:37.938Z",
  "datePublished": "2022-03-15T10:49:07.000Z",
  "dateModified": "2022-03-15T11:09:37.938Z",
  "interactionStatistic": [
    {
      "@type": "InteractionCounter",
      "interactionType": {
        "@type": "LikeAction"
      },
      "userInteractionCount": 2
    },
    {
      "@type": "InteractionCounter",
      "interactionType": {
        "@type": "CommentAction"
      },
      "userInteractionCount": 0
    }
  ],
  "headline_zh-Hans": "Ask HN: 为什么我不能通过这个防火墙脚本访问HTTP://news.yahoo.com？",
  "headline_zh-Hant": "Ask HN: 為什麼我不能通過這個防火牆腳本訪問HTTP://news.yahoo.com？",
  "@context": [
    "https://schema.org",
    {
      "@vocab": "http://schema.org/",
      "@language": "en",
      "headline_zh-Hans": {
        "@id": "headline",
        "@language": "zh-Hans"
      },
      "headline_zh-Hant": {
        "@id": "headline",
        "@language": "zh-Hant"
      },
      "@version": 1.1,
      "description_zh-Hans": {
        "@id": "description",
        "@language": "zh-Hans"
      },
      "description_zh-Hant": {
        "@id": "description",
        "@language": "zh-Hant"
      }
    }
  ],
  "description_zh-Hans": "我被难住了。 我已经使用基于&quot;iptables&quot;的配置运行Linux防火墙多年了。 从未出现过问题。 目前的网关机器运行在10年前安装的CENTOS 6上，所以是时候进行升级了。<p>我安装了Redhat Enterprise 8.5（使用免费的个人开发者许可），它带有内核4.18。 决定进行现代化改造，并使用基于nft的防火墙脚本。<p>乍一看，它是可行的。 但互联网的一个子集是无法访问的。 具体来说，从网关机器以外的任何机器访问 http://news.yahoo.com 的尝试都会失败。 我把这个脚本缩小到最低限度，粘贴在这里：<p>表 ip nat {\n 链条postrouting {\n  type nat hook postrouting priority filter; policy accept;\n  oifname &quot;ppp0&quot; masquerade\n }\n<p>除了news.yahoo.com（似乎还有其他东西在同一个CDN或其他什么地方），一切都能正常工作。<p>我想我会等到RHEL9和它较新的内核，但我用另一台运行FC39（相同内核版本）的机器做了一个测试，问题是一样的。 这也可以工作，但也有上述问题。 在旧的CENTOS 6机器上则没有。 我被难住了。 我可以从哪里开始寻求帮助呢？",
  "description_zh-Hant": "我被難住了。 我已經使用基於&quot;iptables&quot;的配置運行Linux防火牆多年了。 從未出現過問題。 目前的網關機器運行在10年前安裝的CENTOS 6上，所以是時候進行升級了。<p>我安裝了Redhat Enterprise 8.5（使用免費的個人開發者許可），它帶有內核4.18。 決定進行現代化改造，並使用基於nft的防火牆腳本。<p>乍一看，它是可行的。 但互聯網的一個子集是無法訪問的。 具體來說，從網關機器以外的任何機器訪問 http://news.yahoo.com 的嘗試都會失敗。 我把這個腳本縮小到最低限度，粘貼在這裡：<p>表 ip nat {\n 鏈條postrouting {\n  type nat hook postrouting priority filter; policy accept;\n  oifname &quot;ppp0&quot; masquerade\n }\n<p>除了news.yahoo.com（似乎還有其他東西在同一個CDN或其他什麼地方），一切都能正常工作。<p>我想我會等到RHEL9和它較新的內核，但我用另一臺運行FC39（相同內核版本）的機器做了一個測試，問題是一樣的。 這也可以工作，但也有上述問題。 在舊的CENTOS 6機器上則沒有。 我被難住了。 我可以從哪裡開始尋求幫助呢？"
}